@echo off\r\ntitle Instalador Automático do kubectl\r\n\r\necho =====================================================\r\necho  INSTALADOR AUTOMÁTICO DO KUBECTL\r\necho =====================================================\r\necho.\r\n\r\necho Verificando se kubectl já está instalado...\r\nkubectl version --short >nul 2>&1\r\nif %errorlevel% equ 0 (\r\n    echo [OK] kubectl já está instalado\r\n    kubectl version --short\r\n    echo.\r\n    echo Nenhuma ação necessária.\r\n    exit /b 0\r\n)\r\n\r\necho [INFORMAÇÃO] kubectl não encontrado. Iniciando instalação...\r\n\r\necho.\r\necho Detectando arquitetura do sistema...\r\nif \"%PROCESSOR_ARCHITECTURE%\"==\"AMD64\" (\r\n    echo [OK] Arquitetura x64 detectada\r\n    set ARCH=amd64\r\n) else (\r\n    echo [ERRO] Arquitetura não suportada\r\n    exit /b 1\r\n)\r\n\r\necho.\r\necho Baixando a versão mais recente do kubectl...\r\necho Determinando versão mais recente...\r\n\r\nrem Try to get the latest stable version\r\nset KUBECTL_VERSION=latest\r\necho Usando versão mais recente do kubectl\r\n\r\necho.\r\necho Baixando kubectl...\r\nset DOWNLOAD_URL=https://dl.k8s.io/release/%KUBECTL_VERSION%/bin/windows/%ARCH%/kubectl.exe\r\necho URL de download: %DOWNLOAD_URL%\r\n\r\nrem Using curl (available on Windows 10/11) or bitsadmin\r\ncurl --version >nul 2>&1\r\nif %errorlevel% equ 0 (\r\n    echo Usando curl para download...\r\n    curl -LO %DOWNLOAD_URL%\r\n) else (\r\n    echo curl não encontrado, tentando bitsadmin...\r\n    bitsadmin /transfer kubectlDownloadJob %DOWNLOAD_URL% %cd%\\kubectl.exe\r\n)\r\n\r\nif exist \"kubectl.exe\" (\r\n    echo [OK] kubectl baixado com sucesso\r\n) else (\r\n    echo [ERRO] Falha ao baixar kubectl\r\n    echo.\r\n    echo Tentando método alternativo...\r\n    echo Abrindo página de download oficial...\r\n    start \"\" \"https://kubernetes.io/docs/tasks/tools/install-kubectl-windows/\"\r\n    echo.\r\n    echo Por favor:\r\n    echo 1. Baixe o kubectl manualmente\r\n    echo 2. Coloque-o em um diretório no seu PATH\r\n    echo 3. Ou coloque-o neste diretório e execute este script novamente\r\n    exit /b 1\r\n)\r\n\r\necho.\r\necho Determinando localização de instalação...\r\necho Opções:\r\necho 1. Instalar no diretório atual (recomendado para teste)\r\necho 2. Instalar no PATH do sistema (requer administrador)\r\necho 3. Cancelar instalação\r\necho.\r\necho Escolha uma opção (1/2/3):\r\nset /p INSTALL_OPTION=\r\n\r\nif \"%INSTALL_OPTION%\"==\"1\" (\r\n    echo Instalando no diretório atual...\r\n    echo kubectl instalado em: %cd%\\kubectl.exe\r\n    echo.\r\n    echo Para usar o kubectl, execute:\r\n    echo %cd%\\kubectl.exe\r\n    echo.\r\n    echo Para adicionar ao PATH temporariamente, execute:\r\n    echo set PATH=%%PATH%%;%cd%\r\n) else if \"%INSTALL_OPTION%\"==\"2\" (\r\n    echo Instalando no PATH do sistema...\r\n    echo Esta opção requer permissões de administrador.\r\n    \r\n    rem Try to copy to a common location in PATH\r\n    copy kubectl.exe \"C:\\Windows\\System32\\\"\r\n    if %errorlevel% equ 0 (\r\n        echo [OK] kubectl instalado no PATH do sistema\r\n        echo.\r\n        echo Verificando instalação...\r\n        kubectl version --short\r\n        if %errorlevel% equ 0 (\r\n            echo [SUCESSO] kubectl instalado e funcionando corretamente!\r\n        ) else (\r\n            echo [AVISO] kubectl copiado, mas pode haver problemas de permissão\r\n        )\r\n    ) else (\r\n        echo [ERRO] Falha ao copiar para o PATH do sistema\r\n        echo Tente executar este script como administrador\r\n    )\r\n) else (\r\n    echo Instalação cancelada\r\n    del kubectl.exe >nul 2>&1\r\n    exit /b 0\r\n)\r\n\r\necho.\r\necho Limpando arquivos temporários...\r\ndel kubectl.exe >nul 2>&1\r\n\r\necho.\r\necho =====================================================\r\necho INSTALAÇÃO CONCLUÍDA\r\necho =====================================================\r\necho.\r\necho kubectl foi instalado com sucesso!\r\necho.\r\necho Agora você pode:\r\necho 1. Executar: kubectl version\r\necho 2. Continuar com o pipeline de implantação\r\necho.\r\necho Pressione qualquer tecla para sair...\r\npause >nul