<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd"
    name="subreport_rubrica" pageWidth="540" pageHeight="802" columnWidth="540"
    leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0">

    <property name="com.jaspersoft.studio.data.defaultdataadapter" value="One Empty Record" />

    <subDataset name="MovimentoDataset" uuid="a1b2c3d4-e5f6-a7b8-c9d0-e1f2a3b4c5d7">
        <field name="descricao" class="java.lang.String" />
        <field name="valor" class="java.math.BigDecimal" />
    </subDataset>

    <queryString>
        <![CDATA[]]>
    </queryString>

    <field name="nomeRubrica" class="java.lang.String" />
    <field name="totalValor" class="java.math.BigDecimal" />
    <field name="movimentosEntrada" class="java.util.List" />
    <field name="movimentosSaida" class="java.util.List" />

    <detail>
        <band height="40" splitType="Prevent">
            <!-- Cabeçalho da Rubrica -->
            <textField>
                <reportElement x="0" y="0" width="435" height="20" />
                <textElement verticalAlignment="Middle" />
                <textFieldExpression><![CDATA[$F{nomeRubrica}]]></textFieldExpression>
            </textField>
            <textField pattern="¤ #,##0.00">
                <reportElement x="435" y="0" width="105" height="20" />
                <textElement textAlignment="Right" verticalAlignment="Middle" />
                <textFieldExpression><![CDATA[$F{totalValor}]]></textFieldExpression>
            </textField>

            <!-- Detalhes dos Movimentos de Entrada -->
            <componentElement>
                <reportElement x="15" y="20" width="525" height="10" isRemoveLineWhenBlank="true">
                    <printWhenExpression><![CDATA[$F{movimentosEntrada} != null && !$F{movimentosEntrada}.isEmpty()]]></printWhenExpression>
                </reportElement>
                <jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components"
                    xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd"
                    printOrder="Vertical">
                    <datasetRun subDataset="MovimentoDataset"
                        uuid="a1b2c3d4-e5f6-a7b8-c9d0-e1f2a3b4c5d7">
                        <dataSourceExpression><![CDATA[new net.sf.jasperreports.engine.data.JRBeanCollectionDataSource($F{movimentosEntrada})]]></dataSourceExpression>
                    </datasetRun>
                    <jr:listContents height="10" width="525">
                        <textField textAdjust="StretchHeight">
                            <reportElement x="0" y="0" width="425" height="10" />
                            <textFieldExpression><![CDATA[$F{descricao}]]></textFieldExpression>
                        </textField>
                        <textField pattern="¤ #,##0.00">
                            <reportElement x="425" y="0" width="100" height="10" />
                            <textElement textAlignment="Right" />
                            <textFieldExpression><![CDATA[$F{valor}]]></textFieldExpression>
                        </textField>
                    </jr:listContents>
                </jr:list>
            </componentElement>
            <!-- Detalhes dos Movimentos de Saída -->
            <componentElement>
                <reportElement x="15" y="30" width="525" height="10" isRemoveLineWhenBlank="true">
                    <printWhenExpression><![CDATA[$F{movimentosSaida} != null && !$F{movimentosSaida}.isEmpty()]]></printWhenExpression>
                </reportElement>
                <jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components"
                    xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd"
                    printOrder="Vertical">
                    <datasetRun subDataset="MovimentoDataset"
                        uuid="a1b2c3d4-e5f6-a7b8-c9d0-e1f2a3b4c5d7">
                        <dataSourceExpression><![CDATA[new net.sf.jasperreports.engine.data.JRBeanCollectionDataSource($F{movimentosSaida})]]></dataSourceExpression>
                    </datasetRun>
                    <jr:listContents height="10" width="525">
                        <textField textAdjust="StretchHeight">
                            <reportElement x="0" y="0" width="425" height="10" />
                            <textFieldExpression><![CDATA[$F{descricao}]]></textFieldExpression>
                        </textField>
                        <textField pattern="¤ #,##0.00">
                            <reportElement x="425" y="0" width="100" height="10" />
                            <textElement textAlignment="Right" />
                            <textFieldExpression><![CDATA[$F{valor}]]></textFieldExpression>
                        </textField>
                    </jr:listContents>
                </jr:list>
            </componentElement>
        </band>
    </detail>

</jasperReport>